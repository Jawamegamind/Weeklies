<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Your Review · Weeklies</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />
  <style>
    .review-container {
      max-width: 700px;
      margin: 2rem auto;
      padding: 0 1rem;
    }

    .back-link {
      display: inline-block;
      margin-bottom: 1rem;
      color: var(--primary);
      text-decoration: none;
      font-weight: 500;
    }

    .back-link:hover {
      text-decoration: underline;
    }

    .review-header-section {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      padding: 1.5rem;
      margin-bottom: 1.5rem;
    }

    .review-header-section h1 {
      margin: 0 0 0.5rem 0;
      font-size: 1.5rem;
      color: var(--text);
    }

    .review-meta {
      display: flex;
      align-items: center;
      gap: 1rem;
      color: var(--muted);
      font-size: 0.9rem;
      flex-wrap: wrap;
    }

    .review-meta a {
      color: var(--primary);
      text-decoration: none;
    }

    .review-meta a:hover {
      text-decoration: underline;
    }

    .review-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      padding: 2rem;
    }

    .rating-display {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      margin-bottom: 1.5rem;
    }

    .stars-large {
      font-size: 2rem;
      color: #fbbf24;
      letter-spacing: 0.1rem;
    }

    .stars-large .empty-star {
      color: #d1d5db;
    }

    .rating-number {
      font-size: 1.5rem;
      font-weight: 600;
      color: var(--text);
    }

    .review-title {
      font-size: 1.25rem;
      font-weight: 600;
      color: var(--text);
      margin: 0 0 1rem 0;
    }

    .review-description {
      color: var(--text);
      line-height: 1.6;
      margin: 0 0 1.5rem 0;
      white-space: pre-wrap;
      word-break: break-word;
    }

    .review-footer {
      padding-top: 1rem;
      border-top: 1px solid var(--border);
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 1rem;
    }

    .review-date {
      color: var(--muted);
      font-size: 0.9rem;
    }

    .order-link {
      color: var(--primary);
      text-decoration: none;
      font-size: 0.9rem;
      font-weight: 500;
    }

    .order-link:hover {
      text-decoration: underline;
    }

    .restaurant-link-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      padding: 1.25rem;
      margin-top: 1rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .restaurant-link-card h3 {
      margin: 0;
      font-size: 1rem;
      color: var(--text);
    }

    .restaurant-link-card a {
      color: var(--primary);
      text-decoration: none;
      font-weight: 500;
      font-size: 0.9rem;
    }

    .restaurant-link-card a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <header class="site-header">
    <div class="container">
      <a class="brand" href="{{ url_for('index') }}">
        <span class="logo" aria-hidden="true"></span> Weeklies
      </a>
      <nav>
        <a href="{{ url_for('index') }}">Home</a>
        <a href="{{ url_for('profile') }}">Profile</a>
        <a href="{{ url_for('restaurants') }}">Restaurants</a>
        <a href="{{ url_for('orders') }}">Order</a>
        <a href="{{ url_for('logout') }}" data-confirm="Log out now?">Logout</a>
      </nav>
    </div>
  </header>

  <main class="main">
    <div class="review-container">
      <a href="{{ url_for('profile') }}" class="back-link">← Back to Profile</a>

      <!-- Review Header -->
      <div class="review-header-section">
        <h1>Your Review</h1>
        <div class="review-meta">
          <span>Order #{{ review.ord_id }}</span>
          <span>•</span>
          <a href="{{ url_for('restaurant_reviews', rtr_id=review.rtr_id) }}">{{ review.restaurant_name }}</a>
        </div>
      </div>

      <!-- Review Content -->
      <div class="review-card">
        <div class="rating-display">
          <div class="stars-large">
            {% for i in range(review.rating) %}★{% endfor %}{% for i in range(5 - review.rating) %}<span class="empty-star">★</span>{% endfor %}
          </div>
          <div class="rating-number">{{ review.rating }}/5</div>
        </div>

        {% if review.title %}
        <h2 class="review-title">{{ review.title }}</h2>
        {% endif %}

        {% if review.description %}
        <p class="review-description">{{ review.description }}</p>
        {% endif %}

        <div class="review-footer">
          <span class="review-date">
            {% if review.created_at %}
              Submitted on {{ review.created_at }}
            {% else %}
              Review submitted
            {% endif %}
          </span>
          <a href="{{ url_for('order_receipt', ord_id=review.ord_id) }}" class="order-link">
            View Order Receipt →
          </a>
        </div>
      </div>

      <!-- Link to all restaurant reviews -->
      <div class="restaurant-link-card">
        <h3>See all reviews for {{ review.restaurant_name }}</h3>
        <a href="{{ url_for('restaurant_reviews', rtr_id=review.rtr_id, highlight=review.rev_id) }}">
          View All Reviews →
        </a>
      </div>
    </div>
  </main>

  <footer class="footer">
    <div class="container">© 2025 Weeklies</div>
  </footer>
</body>
</html>
